---
import fetchApi from "../lib/strapi.js";

// Define API parameters
const API_ENDPOINT = "books";
const queryParameters = { populate: "cover" };

// Fetch data
const data = await fetchApi(
  { endpoint: API_ENDPOINT, query: queryParameters },
  { method: "GET" }
);

const books = data.data;

---

{books.map((book) => {
  const thumbnailUrl = book.cover?.formats?.thumbnail?.url || "/placeholder-image.jpg";
  console.log(thumbnailUrl); // Log the URL to see what it resolves to

  return (
    <div class="card" key={book.id}>
      <div class="card__image">
        <img
          src={import.meta.env.STRAPI_URL + thumbnailUrl}  
          alt={book.title || "No title"}
        />
      </div>
      <div class="card_txt">
        <h3>{book.title || "No title"}</h3>
      </div>
      <div class="card__content">
        <p class="card__price">&euro; {book.price || "No Price"}</p>
        <button>Read More</button>
      </div>
    </div>
  );
})}


