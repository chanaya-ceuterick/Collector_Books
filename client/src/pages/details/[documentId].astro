---
import Layout from "../../layouts/Layout.astro";
import fetchApi from "../../lib/strapi";

// Fetch book data with Strapi
export async function getStaticPaths() {
  const bookDetail = await fetchApi({
    endpoint: "books",
    wrappedByKey: "data",
    query: { populate: ["cover", "categories"] },
  });

  const paths = bookDetail.map((book) => ({
    params: { documentId: book.documentId.toString() },
    props: {
      book, // Pass the full book object as a prop
    },
  }));

  return paths;
}

// Access the book prop passed to the component
const { book } = Astro.props;
console.log(book);
const coverUrl = `http://localhost:1337${book.cover?.url}`;
---

<Layout>
  <section class="detailBookInfo">
  <img src={coverUrl} alt={book.title} class="detailBookInfo__img">
  <div>
  <h1 class="detailBookInfo__title">{book.title}</h1>
  <h2 class="detailBookInfo__subtitle">{book.description}</h2>
</div></section>
</Layout>

<style>
  .detailBookInfo
  {
    display: flex;
    flex-direction: row;
    gap: var(--s2);
  }

  .detailBookInfo__img
  {
    width: 30vw;
    height: auto;
  }

  .detailBookInfo__title {
    color: var(--c-darkgreen);
    font-size: var(--s2);
    padding: var(--s2) 0;
  }

  .detailBookInfo__subtitle {
    font-size: var(--s1);
    padding: 0;
  }
</style>
